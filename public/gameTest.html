<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<style>
canvas {
    border:1px solid #d3d3d3;
    background-color: #f1f1f1;
}
</style>
</head>
<body onload = "startGame()">
<div>
<h1 id="testgame">Test Game</h1>
</div>

<div>
<canvas id="canvas"></canvas>
</div>

<h2 id="feedback">Grab the items and place them in the correct bins</h2>

<script>
var hand;
var clickX;
var clickY;
var isClicked = false;
var feedback = document.getElementById("feedback");

//Variable that defines an area for the game to be played on the webpage
var myGameArea = 
{
	canvas : document.getElementById("canvas"),
	start : function() 
	{
		this.canvas.width = 720;
		this.canvas.height = 480;
		//Hide Cursor
		this.canvas.style.cursor = "none";
		this.context = this.canvas.getContext("2d");
		
		this.interval = setInterval(updateGameArea, 20);
		
		//Event listeners 
		//Moving the mouse
		document.getElementById("canvas").addEventListener('mousemove', function (e)
		{
                myGameArea.x = e.clientX - document.getElementById("canvas").offsetLeft;
                myGameArea.y = e.clientY - document.getElementById("canvas").offsetTop;
            
		});
		
		//Clicking
		window.addEventListener('mousedown', function (e) 
		{
			clickX = e.pageX;
			clickY = e.pageY;
			
			if(isClicked) 
			{
				isClicked = false;
				
				if(isCollided(waterBottle, recycleBin))
				{
					feedback.innerHTML = "Good Job!\nWater Bottles are Recyclable";
				}
				
				else if(isCollided(waterBottle, trashBin))
				{
					feedback.innerHTML = "Hey that can be recycled!";
				}
			}
			
			else if(waterBottle.clicked())
				isClicked = true;
				
		})		
		
		window.addEventListener('mouseup', function (e) {
		  //myGameArea.x = false;
		  //myGameArea.y = false;
		})
		
		//Touchscreen
		window.addEventListener('touchstart', function (e) {
		  //myGameArea.x = e.pageX;
		  //myGameArea.y = e.pageY;
		})		
		window.addEventListener('touchend', function (e) {
		  //myGameArea.x = false;
		  //myGameArea.y = false;
		})

		
	},
		
		clear : function()
		{
			this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);
		}
		
}

	
//Function to start the game
function startGame()
{
	//Creates a game hand
    
	hand = new component(30, 30, "images/hand.jpg", 10, 120, "image");
	
	//Creates cans
	recycleBin = new component(150, 225, "images/recyclebin.jpg", 30, 250, "image");
	trashBin = new component(150, 225, "images/trashcan.png", 550, 250, "image");
	
	//Creates garbage
	waterBottle = new component(60, 60, "images/bottle.jpg", 30, 30, "image");
	
	myGameArea.start();
}

function createTrash(name, width, height, imgSrc, x, y, recyclable)
{
	name = new component(width, height, imgSrc, x, y, "image");
    
}

//Function to create a component in the game;
function component(width, height, color, x, y, type)
{
	this.type = type;
	
	if(type == "image")
	{
		this.image = new Image();
		this.image.src = color;
	}
	
	this.width = width;
	this.height = height;
	this.speedX = 0;
	this.speedY = 0;
	this.x = x;
	this.y = y;
	
	this.update = function()
	{
		ctx = myGameArea.context;
		if(type == "image")
		{
			ctx.drawImage(this.image, this.x, this.y, this.width, this.height);
		}
		else
		{
			ctx.fillStyle = color;
			ctx.fillRect(this.x, this.y, this.width, this.height);
		}
	}
	
	this.clicked = function() 
	{
		var myleft = this.x;
		var myright = this.x + (this.width);
		var mytop = this.y;
		var mybottom = this.y + (this.height);
		
		var clicked = true;
		
		if ((mybottom < clickY) || (mytop > clickY) || (myright < clickX) || (myleft > clickX)) 
		{
		  clicked = false;
		}
		return clicked;
	}	
}


function isCollided(a, b) {
    return !(
        ((a.y + a.height) < (b.y)) ||
        (a.y > (b.y + b.height)) ||
        ((a.x + a.width) < b.x) ||
        (a.x > (b.x + b.width))
    );
}


function updateGameArea()
{
	myGameArea.clear();
	
	if(myGameArea.x && myGameArea.y)
	{
		hand.x = myGameArea.x;
		hand.y = myGameArea.y;
	}
		
	if(isClicked)
	{
			waterBottle.y = myGameArea.y - (waterBottle.height/4);
			waterBottle.x = myGameArea.x - (waterBottle.width/4);
	}

	

	recycleBin.update();
	trashBin.update();
	
	waterBottle.update();
	
	hand.update();
}

</script>
</body>
</html>

