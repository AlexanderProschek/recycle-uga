<!DOCTYPE html>
<!-- 1st page -->
<html>
    <head>
        <title>UGA Recycling</title>
        
        <!-- Bootstrap stylesheet -->
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

        <!-- UGA fonts from UGA style guide-->
        <link href="https://fonts.googleapis.com/css?family=Merriweather&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Merriweather+Sans&display=swap" rel="stylesheet">
        
        <!-- main stylesheet -->
        <link href="../stylesheets/main.css" rel="stylesheet">
        
        <!-- on page js, mainly window.onload -->
        <script>
            // sets time page is opened
            var pageOpened;
            
            // tracks how many attempts are taken for each question
            var timesChecked = [0, 0, 0, 0];
            
            // runs on page load
            window.onload = function() {
                // time the page was opened for timeOnPage
                pageOpened = new Date();
                
                // number of graphs on the page
                var graphCount = 4;
                
                // making graphs
                var id, title, type, pieData, axisY;
                for(var i = 1; i <= graphCount; i++) {
                    id = "graphContainer" + i.toString();
                    
                    switch(i) {
                        case 1: // info for graph 1
                            title = "UGA Disposal Practices, 2018";
                            type = "pie";            
                            pieData = [{y: 21.9, indexLabel: "Recycled", label: "Recycled", exploded: true}, 
                                           {y: 78.1, indexLabel: "Landfilled", label: "Landfilled"}];
                            break; // source: the powerpoint module
                            
                        case 2: // info for graph 2
                            title = "Energy Savings When Recycled, by Material";
                            type = "column";
                            pieData = [{y: 95, indexLabel: "Aluminum", label: "Aluminum"}, 
                                        {y: 90, indexLabel: "Plastic", label: "Plastic"},
                                        {y: 60, indexLabel: "Paper", label: "Paper"},
                                        {y: 33, indexLabel: "Glass", label: "Glass"}];
                            break; // source: https://www.greenlivingtips.com/articles/recycling-energy-savings.html
                            
                        case 3: // info for graph 3
                            title = "Contaminated Materials Recycled by Percentage";
                            type = "pie";
                            pieData = [{y: 17.5, indexLabel: "Contaminated", label: "Contaminated", exploded: true},
                                        {y: 82.5, indexLabel: "Recycled", label: "Recycled"}];
                            break; // source: https://www.redandblack.com/athensnews/wishful-recycling-turns-wasteful-athens-clarke-county-warns-of-recycling/article_7c927d42-6f64-11e8-8ed1-ef48e8d384a2.html
                            
                        case 4:  // info for graph 4
                            title = "Value of Landfilled Materials and Amount Paid to Landfill";
                            type = "column";            
                            pieData = [{y: 300, indexLabel: "Value of Waste", label: "Value of Waste", exploded: true}, 
                                        {y: 100, indexLabel: "Amount Paid", label: "Amount Paid"},];
                    } // creating each of the different graph info variables
                    
                    // for first three graphs, use percentage for y axis
                    // for fourth, use millions of units
                    if(i < 4)
                        makeGraph(id, title, type, pieData, "##0.00\"%\"");
                    else 
                        makeGraph(id, title, type, pieData, "$## million");
                } // for each of the four graphs, assign graph info                
                
                // for each graph, starting at one, alternate the side of the window the graph is on
                // and make the info text float the opposite direction               
                for(var i = 1; i <= graphCount; i++) {
                    
                    // the number of the current graph, used to get the correct id #s
                    var graphnum = i.toString();

                    // changes html forms named 'answer' + number to not clear text on submit
                    document.getElementsByName("answer" + graphnum)[0].addEventListener("submit", function(e) {
                        e.preventDefault(); 
                    });
                    
                    // makes text popups
                    makePopupText("graphArea" + graphnum, "infoText" + graphnum, "question" + graphnum);
                    
                    // if the graph id is even, float right & text left, else float left & text right
                    if(i % 2 == 0) {
                        // floating the graph area and container to the right
                        document.getElementById("graphArea" + graphnum).style.float = "right";
                        document.getElementById("graphContainer" + graphnum).style.float = "right";
                        document.getElementById("graphArea" + graphnum).style.margin = "5px 5% 5px 35%";
                        
                        // moving the question over to account for space for popup text
                        document.getElementById("question" + graphnum).style.margin = "10px 5px 10px 325px";
                    } else {
                        // floating graph area and container to the left
                        document.getElementById("graphArea" + graphnum).style.float = "left";
                        document.getElementById("graphContainer" + graphnum).style.float = "left";
                        document.getElementById("graphArea" + graphnum).style.margin = "5px 35% 5px 5%";
                        
                        // leaving question in place because it is correctly placed already
                        document.getElementById("question" + graphnum).style.margin = "10px 5px 10px 5px";
                    } // if-else

                } // for all graphs
                
            } // on window load
            
            //checks answer against known correct answer and displays
            //text based on its correctness
            function checkAnswer(questionNumber) {
                // boolean for question correctness
                var isCorrect = false;
                
                //incrementing question attempts
                timesChecked[questionNumber - 1]++;
                
                switch(questionNumber) {
                    // each case represents its respective question
                    // answer values have been hashed prior to deplyoment and 
                    // are compared to their has values
                    case 1:
                        if(SHA256(document.getElementsByName("answer1").item(0).value) === "785f3ec7eb32f30b90cd0fcf3657d388b5ff4297f2f9716ff66e9b69c05ddd09") {isCorrect = true;}
                        else {isCorrect = false;}
                        break;
                        
                        // real answer: 22 (% not included)
                        // 785f3ec7eb32f30b90cd0fcf3657d388b5ff4297f2f9716ff66e9b69c05ddd09
                    case 2:
                        if(SHA256(document.getElementsByName("answer2").item(0).value) === "69f59c273b6e669ac32a6dd5e1b2cb63333d8b004f9696447aee2d422ce63763") {isCorrect = true;}
                        break;
                        
                        // real answer: 90 (% not included)
                        // 69f59c273b6e669ac32a6dd5e1b2cb63333d8b004f9696447aee2d422ce63763
                    case 3:
                        if(SHA256(document.getElementsByName("answer3").item(0).value.toUpperCase()) === "867ad3c680945db98117600daa606713ee7b5a911f786c19cf9ce36eed58192c") {isCorrect = true;}
                        break;
                        
                        // real answer: 'wishful' (case insensitive)
                        // 867ad3c680945db98117600daa606713ee7b5a911f786c19cf9ce36eed58192c
                    case 4:
                        if(SHA256(document.getElementsByName("answer4").item(0).value) === "d4735e3a265e16eee03f59718b9b5d03019c07d8b6c51f90da3a666eec13ab35" || 
                          SHA256(document.getElementsByName("answer4").item(0).value) === "c21365c7ea5b3c9d9326726c52d1ba5f14961d6767619fb1aa14255d4c42e759") {isCorrect = true;}
                        
                        // real answer: 2 or 2nd
                        // d4735e3a265e16eee03f59718b9b5d03019c07d8b6c51f90da3a666eec13ab35 (2)
                        // c21365c7ea5b3c9d9326726c52d1ba5f14961d6767619fb1aa14255d4c42e759 (2nd)
                        
                        // source for graph:
                        // https://cdn.ymaws.com/www.productstewardship.us/resource/resmgr/imported/SERDC%20Econ%20Cards.pdf
                } // switch for each question depending on question number
                
                // if correct, show correct, else show incorrect
                if(isCorrect) {
                    document.getElementById("correct" + questionNumber.toString()).innerHTML = "Correct!";
                    document.getElementById("correct" + questionNumber.toString()).style.color = "green";
                    document.getElementById("submit" + questionNumber.toString()).classList.add("disabled");
                    document.getElementsByName("answer" + questionNumber.toString())[0].readOnly = true;
                } else {
                    document.getElementById("correct" + questionNumber.toString()).innerHTML = "Incorrect!";
                    document.getElementById("correct" + questionNumber.toString()).style.color = "red";
                    document.getElementsByName("answer" + questionNumber.toString())[0].value = "";
                } // if correct, else
            } // checkAnswer
            
            // posts 'things' (data) to the server 
            function postThings() {
                
                // time the page was closed for timeOnPage
                var pageClosed = new Date();
                
                // variable to be converted to JSON
                var serverInfo = {page: 1,
                        data: { answer1: document.getElementsByName("answer1")[0].value,
                                answer2: document.getElementsByName("answer2")[0].value, 
                                answer3: document.getElementsByName("answer3")[0].value,
                                answer4: document.getElementsByName("answer4")[0].value,
                                attemptsPerQuestion: timesChecked,
                                metaData: {timeOnPage: pageClosed - pageOpened}
                              }
                };
                
                // posts data to the backend
                $.ajax({
                    type: "POST",
                    url: "/module/progress",
                    data: JSON.stringify(serverInfo),
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function(data){alert("post sucessful");},
                    failure: function(){alert("post failed");}
                });
                
                location.reload(true);
            } // postThings
        </script>
    </head>
    <body>
        <!-- Fixed navigation bar using bootsrap classes, UGA Bulldog Red color, UGA font-->
        <nav class="navbar navbar-fixed-top" style="background-color: #BA0C2F;">
            <div class="container">
                <div class="navbar-header" style="font-size: 24pt; color:white; font-family: 'Merriweather', rserif; text-align: center">
                    Roosevelt@UGA Sustainability Project
                </div>
            </div>
        </nav>
        
        <div id="page2">
            <p style="text-align: center; margin-top: 20px;">Hover over the graphs and answer all questions to continue!<br>
                <b>answers in order: '22', '90', 'wishful' (case insensitive), '2' or '2nd'</b>
            </p>

            <!-- (some) Information from Slide 3 of PP module (uses window.onload function) -->
            <div id="graphArea1" class="graphArea">
                <div id="graphContainer1" class="graphContainer"></div>
                <div id="question1" class="question">
                    <h3>What percentage of the Athens waste stream is recycled?</h3>
                
                    <div class="answers">
                        <input type="text" name="answer1" maxlength="2" class="answerText"/>
                    </div>
                    
                    <a href="javascript:checkAnswer(1);checkIfCompleteInfo()" id="submit1" class="submitButton">Check Answer</a>
                    
                    <p id="correct1" class="correct"></p>
                </div>
                <p id="infoText1" class="popup">&emsp; Annually, the US recycles 34.3% of solid waste on average, yet the EPA estimates that over 75% of US waste is recyclable. In 2018, UGA sent 5,474 tons of waste to landfills and recycled only <i>~1,200 tons</i> of materials (... and we have recycling bins across the entire campus). This amounts to less than 22% of our waste being recycled - a number that is far too low.</p>
            </div>

            <div id="graphArea2" class="graphArea">
                <div id="graphContainer2" class="graphContainer"></div>
                <div id="question2" class="question">
                    <h3>How much energy (percentage) is saved when products are made with recycled plastics compared to virgin plastics?</h3>
                
                    <div class="answers">
                        <input type="text" name="answer2" maxlength="2" class="answerText"/>
                    </div>

                    <a href="javascript:checkAnswer(2);checkIfCompleteInfo()" id="submit2" class="submitButton">Check Answer</a>
                    
                    <p id="correct2" class="correct"></p>
                </div>
                <p id="infoText2" class="popup">&emsp; Not only does recycling waste save material that could end up in a landfill or in one of many bodies of water, it also saves copious amounts of energy compared to creating products from virgin materials (those that haven't been recycled). Not only does recycling help the earth, it makes the creation of new products more efficient!</p>
            </div>

            <div id="graphArea3" class="graphArea">
                <div id="graphContainer3" class="graphContainer"></div>
                <div id="question3" class="question">
                    <h3>What kind of recycling results in most cases of contamination?</h3>
                
                    <div class="answers">
                        <input type="text" name="answer3" maxlength="10" class="answerText"/>
                    </div>
                    
                    <a href="javascript:checkAnswer(3);checkIfCompleteInfo()" id="submit3" class="submitButton">Check Answer</a>
                    
                    <p id="correct3" class="correct"></p>
                </div>
                <p id="infoText3" class="popup">&emsp; In the Athens-Clarke County recycling plant, an average of 80 tons of materials are sent to be recycled daily. Of the 80 tons, around 17.5% becomes contaminated by food or non-recyclable waste and sent to a landfill. Contamination usually comes from "wishful recycling", or tossing out waste into a recycling bin without knowing if it's the correct bin. It's important to know what kind of materials can be put into a bin because otherwise the entire bin could become contaminated!</p>
            </div>

            <div id="graphArea4" class="graphArea">
                <div id="graphContainer4" class="graphContainer"></div>
                <div id="question4" class="question">
                    <h3>Where does Georgia rank by state in terms of market for recycled materials?</h3>
                
                    <div class="answers">
                        <input type="text" name="answer4" maxlength="3" class="answerText"/>
                    </div>
                    
                    <a href="javascript:checkAnswer(4);checkIfCompleteInfo()" id="submit4" class="submitButton">Check Answer</a>
                        
                    <p id="correct4" class="correct"></p>
                </div>
                <p id="infoText4" class="popup">&emsp; Even though Athens struggles to recycle at the national average, Georgia is a fantastic place for the recycling industry - Georgia has the second largest market for recycled materials by state. In our state, over 120 business use recycled products and these companies employ over <i>23,000</i> people. Similarly, one third of all plastic beverage containers recycled in North America are recycled in Dalton, Georgia with most contributing to its world-class carpet manufacturing industry.</p>
            </div>
        </div>

        <a onclick="postThings()" href="/module/next" class="nextPageButton disabled">Next Page</a>
        
        <!-- Load all the Bootstrap requirements at the end of the document -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

        <!-- CanvasJS for creating charts & graphs with animation-->
        <script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>

        <!-- Importing js files from javascripts folder in public -->
        <script src="../javascripts/graphs.js"></script>
        <script src="../javascripts/popup.js"></script>
        <script src="../javascripts/hashing.js"></script>
        <script src="../javascripts/pageCompleteCheck.js"></script>
    </body>
</html>